define("lib/misc/csrf_ajax_protection_setup",[],function(){return function(){$.ajaxSetup({beforeSend:function(a,b){function c(a){var b=null;if(document.cookie&&document.cookie!=""){var c=document.cookie.split(";");for(var d=0;d<c.length;d++){var e=jQuery.trim(c[d]);if(e.substring(0,a.length+1)==a+"="){b=decodeURIComponent(e.substring(a.length+1));break}}}return b}!/^http:.*/.test(b.url)&&!/^https:.*/.test(b.url)&&a.setRequestHeader("X-CSRFToken",c("csrftoken"))}})}}),function(){function d(a){var c=!1;return function(){if(c)throw new Error("Callback was already called.");c=!0,a.apply(b,arguments)}}var a={},b,c;b=this,b!=null&&(c=b.async),a.noConflict=function(){return b.async=c,a};var e=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},f=function(a,b){if(a.map)return a.map(b);var c=[];return e(a,function(a,d,e){c.push(b(a,d,e))}),c},g=function(a,b,c){return a.reduce?a.reduce(b,c):(e(a,function(a,d,e){c=b(c,a,d,e)}),c)},h=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};typeof process=="undefined"||!process.nextTick?typeof setImmediate=="function"?(a.nextTick=function(a){setImmediate(a)},a.setImmediate=a.nextTick):(a.nextTick=function(a){setTimeout(a,0)},a.setImmediate=a.nextTick):(a.nextTick=process.nextTick,typeof setImmediate!="undefined"?a.setImmediate=setImmediate:a.setImmediate=a.nextTick),a.each=function(a,b,c){c=c||function(){};if(!a.length)return c();var f=0;e(a,function(e){b(e,d(function(b){b?(c(b),c=function(){}):(f+=1,f>=a.length&&c(null))}))})},a.forEach=a.each,a.eachSeries=function(a,b,c){c=c||function(){};if(!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c(null):e())})};e()},a.forEachSeries=a.eachSeries,a.eachLimit=function(a,b,c,d){var e=i(b);e.apply(null,[a,c,d])},a.forEachLimit=a.eachLimit;var i=function(a){return function(b,c,d){d=d||function(){};if(!b.length||a<=0)return d();var e=0,f=0,g=0;(function h(){if(e>=b.length)return d();while(g<a&&f<b.length)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})})()}},j=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[a.each].concat(c))}},k=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[i(a)].concat(c))}},l=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[a.eachSeries].concat(c))}},m=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};a.map=j(m),a.mapSeries=l(m),a.mapLimit=function(a,b,c,d){return n(b)(a,c,d)};var n=function(a){return k(a,m)};a.reduce=function(b,c,d,e){a.eachSeries(b,function(a,b){d(c,a,function(a,d){c=d,b(a)})},function(a){e(a,c)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(b,c,d,e){var g=f(b,function(a){return a}).reverse();a.reduce(g,c,d,e)},a.foldr=a.reduceRight;var o=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(f(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};a.filter=j(o),a.filterSeries=l(o),a.select=a.filter,a.selectSeries=a.filterSeries;var p=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(f(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};a.reject=j(p),a.rejectSeries=l(p);var q=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};a.detect=j(q),a.detectSeries=l(q),a.some=function(b,c,d){a.each(b,function(a,b){c(a,function(a){a&&(d(!0),d=function(){}),b()})},function(a){d(!1)})},a.any=a.some,a.every=function(b,c,d){a.each(b,function(a,b){c(a,function(a){a||(d(!1),d=function(){}),b()})},function(a){d(!0)})},a.all=a.every,a.sortBy=function(b,c,d){a.map(b,function(a,b){c(a,function(c,d){c?b(c):b(null,{value:a,criteria:d})})},function(a,b){if(a)return d(a);var c=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};d(null,f(b.sort(c),function(a){return a.value}))})},a.auto=function(b,c){c=c||function(){};var d=h(b);if(!d.length)return c(null);var f={},i=[],j=function(a){i.unshift(a)},k=function(a){for(var b=0;b<i.length;b+=1)if(i[b]===a){i.splice(b,1);return}},l=function(){e(i.slice(0),function(a){a()})};j(function(){h(f).length===d.length&&(c(null,f),c=function(){})}),e(d,function(d){var i=b[d]instanceof Function?[b[d]]:b[d],m=function(b){var g=Array.prototype.slice.call(arguments,1);g.length<=1&&(g=g[0]);if(b){var i={};e(h(f),function(a){i[a]=f[a]}),i[d]=g,c(b,i),c=function(){}}else f[d]=g,a.setImmediate(l)},n=i.slice(0,Math.abs(i.length-1))||[],o=function(){return g(n,function(a,b){return a&&f.hasOwnProperty(b)},!0)&&!f.hasOwnProperty(d)};if(o())i[i.length-1](m,f);else{var p=function(){o()&&(k(p),i[i.length-1](m,f))};j(p)}})},a.waterfall=function(b,c){c=c||function(){};if(b.constructor!==Array){var d=new Error("First argument to waterfall must be an array of functions");return c(d)}if(!b.length)return c();var e=function(b){return function(d){if(d)c.apply(null,arguments),c=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=b.next();g?f.push(e(g)):f.push(c),a.setImmediate(function(){b.apply(null,f)})}}};e(a.iterator(b))()};var r=function(a,b,c){c=c||function(){};if(b.constructor===Array)a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(h(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};a.parallel=function(b,c){r({map:a.map,each:a.each},b,c)},a.parallelLimit=function(a,b,c){r({map:n(b),each:i(b)},a,c)},a.series=function(b,c){c=c||function(){};if(b.constructor===Array)a.mapSeries(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.eachSeries(h(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}},a.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},a.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var s=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};a.concat=j(s),a.concatSeries=l(s),a.whilst=function(b,c,d){b()?c(function(e){if(e)return d(e);a.whilst(b,c,d)}):d()},a.doWhilst=function(b,c,d){b(function(e){if(e)return d(e);c()?a.doWhilst(b,c,d):d()})},a.until=function(b,c,d){b()?d():c(function(e){if(e)return d(e);a.until(b,c,d)})},a.doUntil=function(b,c,d){b(function(e){if(e)return d(e);c()?d():a.doUntil(b,c,d)})},a.queue=function(b,c){function f(b,d,f,g){d.constructor!==Array&&(d=[d]),e(d,function(d){var e={data:d,callback:typeof g=="function"?g:null};f?b.tasks.unshift(e):b.tasks.push(e),b.saturated&&b.tasks.length===c&&b.saturated(),a.setImmediate(b.process)})}c===undefined&&(c=1);var g=0,h={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,push:function(a,b){f(h,a,!1,b)},unshift:function(a,b){f(h,a,!0,b)},process:function(){if(g<h.concurrency&&h.tasks.length){var a=h.tasks.shift();h.empty&&h.tasks.length===0&&h.empty(),g+=1;var c=function(){g-=1,a.callback&&a.callback.apply(a,arguments),h.drain&&h.tasks.length+g===0&&h.drain(),h.process()},e=d(c);b(a.data,e)}},length:function(){return h.tasks.length},running:function(){return g}};return h},a.cargo=function(b,c){var d=!1,g=[],h={tasks:g,payload:c,saturated:null,empty:null,drain:null,push:function(b,d){b.constructor!==Array&&(b=[b]),e(b,function(a){g.push({data:a,callback:typeof d=="function"?d:null}),h.saturated&&g.length===c&&h.saturated()}),a.setImmediate(h.process)},process:function i(){if(d)return;if(g.length===0){h.drain&&h.drain();return}var a=typeof c=="number"?g.splice(0,c):g.splice(0),j=f(a,function(a){return a.data});h.empty&&h.empty(),d=!0,b(j,function(){d=!1;var b=arguments;e(a,function(a){a.callback&&a.callback.apply(null,b)}),i()})},length:function(){return g.length},running:function(){return d}};return h};var t=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(b?console.error&&console.error(b):console[a]&&e(c,function(b){console[a](b)}))}]))}};a.log=t("log"),a.dir=t("dir"),a.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),g=b.apply(null,e);g in c?f.apply(null,c[g]):g in d?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([function(){c[g]=arguments;var a=d[g];delete d[g];for(var b=0,e=a.length;b<e;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},a.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},a.times=function(b,c,d){var e=[];for(var f=0;f<b;f++)e.push(f);return a.map(e,c,d)},a.timesSeries=function(b,c,d){var e=[];for(var f=0;f<b;f++)e.push(f);return a.mapSeries(e,c,d)},a.compose=function(){var b=Array.prototype.reverse.call(arguments);return function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();a.reduce(b,d,function(a,b,d){b.apply(c,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,b){e.apply(c,[a].concat(b))})}};var u=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};a.applyEach=j(u),a.applyEachSeries=l(u),a.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},typeof define!="undefined"&&define.amd?define("lib/async",[],function(){return a}):typeof module!="undefined"&&module.exports?module.exports=a:b.async=a}(),define("lib/error_lib",[],function(){function b(a){return a.statusText!=undefined&&a.status!=undefined}function c(a){return a&&typeof a=="string"&&a.indexOf("ERROR_CANCEL_")==0}function d(b){c(b)||(e(b)?alert(a):f(b)?alert(a):alert("There is untreated error:"+b))}function e(a){return b(a)&&a.status==0}function f(a){return a.__proto__&&a.__proto__.name=="unknown_error"&&a.__proto__.message=="Database encountered an unknown error"}var a="Internet is disconnected. Try again later.";return{alert_error:d,is_xhr_obj:b,is_offline_error:e}}),define("lib/number/number",[],function(){function a(a){return+a.toFixed(5)}function b(a){return+a.toFixed(2)}function c(a,b,c){var e=prompt(a,b);return d(e)?parseInt(e):null}function d(a){return parseInt(a)%1==0}function e(a,b,c){var d=prompt(a,b);return d==null?null:h(d)?parseInt(d):(c&&alert(c),null)}function f(a,b,c){var d=prompt(a,b);if(d==null)return null;if(g(d))return parseFloat(d);if(c)return alert(c),null}function g(a){if(a==null)return!1;if(isNaN(a))return!1;var b=parseFloat(a);return b>=0?!0:!1}function h(a){var b=/^\d+$/;return b.test(a)}return{prompt_positive_integer:e,is_positive_integer:h,prompt_positive_double:f,is_positive_double:g,round_2_decimal:b,trim:a,prompt_integer:c}}),define("app/group/group_validator",["lib/number/number"],function(a){function c(a){var c=new Array,d=a.name,e=a.group_child_sp_lst;return(!d||d.trim().length==0)&&c.push(b),c}var b="ERROR_GROUP_VALIDATION_NAME";return{validate:c,ERROR_GROUP_VALIDATION_NAME:b}}),define("app/store_product/sp_online_searcher",[],function(){function c(b,c){var b=b.trim();if(!b){c(a);return}$.ajax({url:"/product/search/name_ajax",type:"GET",data:{name_str:b},dataType:"json",success:function(a,b,d){c(null,a.prod_lst)},error:function(a,b,d){c(a)}})}function d(a,c){var a=a.trim();if(!a){c(b);return}$.ajax({url:"/product/search/sku_ajax",type:"GET",data:{sku_str:a},dataType:"json",success:function(a,b,d){c(null,a)},error:function(a,b,d){c(a)}})}var a="NAME_SEARCH_ERROR_EMPTY",b="SKU_SEARCH_ERROR_EMPTY";return{NAME_SEARCH_ERROR_EMPTY:a,SKU_SEARCH_ERROR_EMPTY:b,name_search:c,sku_search:d}}),define("app/product/product_json_helper",[],function(){function a(a,b){var c=null;for(var d=0;d<b.length;d++)if(b[d].product_id==a){c=b[d];break}return c}function b(a,b){var c=null;for(var d=0;d<b.length;d++)if(b[d].product_id==a){c=b[d];break}return c}function c(a,b){var c=null;if(b==null)c=a.store_product_set[0];else for(var d=0;d<a.store_product_set.length;d++){var e=a.store_product_set[d];if(e.store_id==b){c=e;break}}return c}function d(a){return prod_sku_assoc_set=a.prodskuassoc_set,prod_sku_assoc_set==null&&(prod_sku_assoc_set=[]),prod_sku_assoc_set}function e(a,b){var c=!1;for(var d=0;d<b.length;d++)if(b[d].store_id==a){c=!0;break}return c}function f(a,b,c){var d=!1,e=null;for(var f=0;f<b.length;f++)if(b[f].sku_str==c){e=b[f];break}for(var f=0;f<e.store_set.length;f++)if(e.store_set.indexOf(a)!=-1){d=!0;break}return d}function g(a,b,c,d,g){var h=new Array;for(var i=0;i<a.length;i++){var j=a[i],k,l;k=e(b,a[i].store_product_set)==c,g==null?l=!0:l=f(b,a[i].prodskuassoc_set,g)==d,k&&l&&h.push(j)}return h}return{get_prod_sku_assoc_set:d,get_sp_from_p:c,extract_prod_store__prod_sku:g,get_p_from_lst:b,get_sp_from_sp_lst:a}}),define("app/store_product/sp_online_name_search_ui",["lib/async","app/store_product/sp_online_searcher","app/product/product_json_helper","lib/error_lib"],function(a,b,c,d){function f(a){$("#product_search_dlg").dialog("close"),a(e)}function g(c){$("#product_search_txt").keypress(function(e){var f=e.keyCode?e.keyCode:e.which;if(f=="13"){var g=$("#product_search_txt").val().trim();if(!g)return;var i=b.name_search.bind(b.name_search,g);a.waterfall([i],function(a,b){a?d.alert_error(a):h(b,c)})}})}function h(a,b){var d=document.getElementById("product_search_tbl");d.innerHTML="";var e,f,g=["product","price","crv","taxable","type","tag","select"];e=d.insertRow(-1);for(var h=0;h<g.length;h++)f=e.insertCell(-1),f.innerHTML=g[h];for(var h=0;h<a.length;h++){var e=d.insertRow(-1),i=null,j=c.get_sp_from_p(a[h],i);f=e.insertCell(-1),f.innerHTML=j.name,f=e.insertCell(-1),f.innerHTML=j.price,f=e.insertCell(-1),f.innerHTML=j.crv,f=e.insertCell(-1),f.innerHTML=j.is_taxable,f=e.insertCell(-1),f.innerHTML=j.p_type,f=e.insertCell(-1),f.innerHTML=j.p_tag,f=e.insertCell(-1),f.innerHTML="select",function(a){f.addEventListener("click",function(){$("#product_search_dlg").dialog("close"),b(null,a)})}(j)}}function i(a){var b=f.bind(f,a);$("#product_search_dlg").dialog({title:"search product",buttons:[{text:"exit",click:b}],modal:!0,width:800,height:500}),g(a),$("#product_search_txt").val(""),h([],a),$("#product_search_dlg").dialog("open")}var e="ERROR_CANCEL_product_search_exit_button_press";return{exe:i,ERROR_CANCEL_product_search_exit_button_press:e}}),define("app/group/group_prompt",["lib/async","app/group/group_validator","app/store_product/sp_online_name_search_ui","lib/error_lib","app/product/product_json_helper"],function(a,b,c,d,e){function i(a){$("#group_prompt_dlg").dialog("close"),a(f)}function j(a){var c=n(),d=b.validate(c);d.length==0?($("#group_prompt_dlg").dialog("close"),a(null,c)):l(d)}function k(){a.waterfall([c.exe],function(a,b){if(a){d.alert_error(a);return}var c=b;e.get_sp_from_sp_lst(c.product_id,h)==null?(h.push(c),p()):alert("product is already in list")})}function l(a){$("#group_name_txt").removeClass("error"),$("label[for='group_child_tbl']").removeClass("error"),$("label[for='group_child_tbl']").text("items"),a.indexOf(b.ERROR_GROUP_VALIDATION_NAME)!=-1&&$("#group_name_txt").addClass("error")}function m(a){var b="group",c=j.bind(j,a),d=i.bind(i,a);$("#group_prompt_dlg").dialog({title:b,buttons:[{text:"Ok",click:c},{text:"Cancel",click:d}],modal:!0,width:600,heigh:400}),$("#group_prompt_dlg").dialog("open")}function n(){var a=$("#group_name_txt").val(),b={name:a,group_child_sp_lst:h};return b}function o(a){if(!confirm("remove item?"))return;h.splice(a,1),p()}function p(){g.innerHTML="";var a,b;a=g.insertRow(-1);var c=["name","reg price","crv","is_taxable","remove"];for(var d=0;d<c.length;d++)b=a.insertCell(-1),b.innerHTML=c[d];for(var d=0;d<h.length;d++){a=g.insertRow(-1);var e=h[d];b=a.insertCell(-1),b.innerHTML=e.name,b=a.insertCell(-1),b.innerHTML=e.price,b=a.insertCell(-1),b.innerHTML=e.crv,b=a.insertCell(-1),b.innerHTML=e.is_taxable,b=a.insertCell(-1),b.innerHTML="remove",function(a){b.addEventListener("click",function(){o(a)})}(d)}}function q(a,b,c){$("#group_add_child_btn").off("click").click(k),$("#group_name_txt").val(a),h=b,p(),l([]),m(c)}var f="ERROR_CANCEL_GROUP_PROMPT",g=document.getElementById("group_child_tbl"),h=[];return{ERROR_CANCEL_GROUP_PROMPT:f,exe:q}}),define("app/store_product/store_product_util",[],function(){function a(a,b){var c=null;for(var d=0;d<b.length;d++)if(b[d]._id===a){c=b[d];break}return c}function b(a,b){var c=null;for(var d=0;d<b.length;d++)if(b[d].product_id===a){c=b[d];break}return c}function c(a){var b="";for(var c=0;c<a.length;c++)b+=","+a[c].product_id;return b.substr(1)}return{get_item_based_on_product_id:b,get_item_based_on_doc_id:a,get_comma_separated_pid_lst:c}}),define("app/group/group_inserter",["lib/async","lib/error_lib","app/group/group_prompt","app/store_product/store_product_util"],function(a,b,c,d){function e(a,b){var c=d.get_comma_separated_pid_lst(a.group_child_sp_lst),e={name:a.name,pid_comma_separated_lst_str:c};$.ajax({url:"/group/insert",type:"POST",dataType:"json",data:e,success:function(a,c,d){b(null,a)},error:function(a,c,d){b(a)}})}function f(b){var d=c.exe.bind(c.exe,null,[]);a.waterfall([d,e],function(a,c){b(a,c)})}return{exe:f}}),define("app/group/group_updator",["lib/async","app/group/group_prompt","app/store_product/store_product_util"],function(a,b,c){function d(a,b,d){var e=c.get_comma_separated_pid_lst(b.group_child_sp_lst),f={id:a,name:b.name,qty:b.qty,unit_discount:b.unit_discount,pid_comma_separated_lst_str:e};$.ajax({url:"/group/update",type:"POST",dataType:"json",data:f,success:function(a,b,c){d(null,a)},error:function(a,b,c){d(a)}})}function e(c,e){var f=[];for(var g=0;g<c.group_child_set.length;g++)f.push(c.group_child_set[g].store_product);var h=b.exe.bind(b.exe,c.name,f),i=d.bind(d,c.id);a.waterfall([h,i],function(a,b){e(a,b)})}return{exe:e}}),define("app/group/group_action_validator",["lib/number/number"],function(a){function l(f){var g=new Array,h=f.price,l=f.crv,m=f.is_taxable,n=f.is_sale_report,o=f.p_type,p=f.p_tag,q=f.vendor,r=f.cost,s=f.buydown;return!h&&!l&&!m&&!n&&!o&&!p&&!q&&!r&&!s&&g.push(k),h!=null&&h!=undefined&&typeof h=="string"&&h.trim().length!=0&&!a.is_positive_double(h)&&g.push(b),l!=null&&l!=undefined&&typeof l=="string"&&l.trim().length!=0&&!a.is_positive_double(l)&&g.push(c),m!=null&&m!=undefined&&typeof m=="string"&&m.trim().length!=0&&m!="true"&&m!="false"&&g.push(d),n!=null&&n!=undefined&&typeof n=="string"&&n.trim().length!=0&&n!="true"&&n!="false"&&g.push(e),r!=null&&r!=undefined&&typeof r=="string"&&r.trim().length!=0&&!a.is_positive_double(r)&&g.push(i),s!=null&&s!=undefined&&typeof s=="string"&&s.trim().length!=0&&!a.is_positive_double(s)&&g.push(j),g}var b="ERROR_GROUP_ACTION_VALIDATION_PRICE",c="ERROR_GROUP_ACTION_VALIDATION_CRV",d="ERROR_GROUP_ACTION_VALIDATION_IS_TAXABLE",e="ERROR_GROUP_ACTION_VALIDATION_IS_SALE_REPORT",f="ERROR_GROUP_ACTION_VALIDATION_P_TYPE",g="ERROR_GROUP_ACTION_VALIDATION_P_TAG",h="ERROR_GROUP_ACTION_VALIDATION_VENDOR",i="ERROR_GROUP_ACTION_VALIDATION_COST",j="ERROR_GROUP_ACTION_VALIDATION_BUYDOWN",k="ERROR_GROUP_ACTION_VALIDATION_EMPTY_ACTION";return{validate:l,ERROR_GROUP_ACTION_VALIDATION_PRICE:b,ERROR_GROUP_ACTION_VALIDATION_CRV:c,ERROR_GROUP_ACTION_VALIDATION_IS_TAXABLE:d,ERROR_GROUP_ACTION_VALIDATION_IS_SALE_REPORT:e,ERROR_GROUP_ACTION_VALIDATION_P_TYPE:f,ERROR_GROUP_ACTION_VALIDATION_P_TAG:g,ERROR_GROUP_ACTION_VALIDATION_VENDOR:h,ERROR_GROUP_ACTION_VALIDATION_COST:i,ERROR_GROUP_ACTION_VALIDATION_BUYDOWN:j,ERROR_GROUP_ACTION_VALIDATION_EMPTY_ACTION:k}}),define("app/group/group_action_prompt",["lib/async","app/group/group_action_validator"],function(a,b){function d(a){$("#group_action_price_txt").removeClass("error"),$("#group_action_crv_txt").removeClass("error"),$("#group_action_is_taxable_txt").removeClass("error"),$("#group_action_is_sale_report_txt").removeClass("error"),$("#group_action_p_type_txt").removeClass("error"),$("#group_action_p_tag_txt").removeClass("error"),$("#group_action_vendor_txt").removeClass("error"),$("#group_action_cost_txt").removeClass("error"),$("#group_action_buydown_txt").removeClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_EMPTY_ACTION)!=-1&&alert("specify action to perform"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_PRICE)!=-1&&$("#group_action_price_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_CRV)!=-1&&$("#group_action_crv_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_IS_TAXABLE)!=-1&&$("#group_action_is_taxable_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_IS_SALE_REPORT)!=-1&&$("#group_action_is_sale_report_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_P_TYPE)!=-1&&$("#group_action_p_type_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_P_TAG)!=-1&&$("#group_action_p_tag_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_VENDOR)!=-1&&$("#group_action_vendor_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_COST)!=-1&&$("#group_action_cost_txt").addClass("error"),a.indexOf(b.ERROR_GROUP_ACTION_VALIDATION_BUYDOWN)!=-1&&$("#group_action_buydown_txt").addClass("error")}function e(){var a={price:$("#group_action_price_txt").val(),crv:$("#group_action_crv_txt").val(),is_taxable:$("#group_action_is_taxable_txt").val(),is_sale_report:$("#group_action_is_sale_report_txt").val(),p_type:$("#group_action_p_type_txt").val(),p_tag:$("#group_action_p_tag_txt").val(),vendor:$("#group_action_vendor_txt").val(),cost:$("#group_action_cost_txt").val(),buydown:$("#group_action_buydown_txt").val()};return a}function f(a){$("#group_action_prompt_dialog").dialog("close"),a(c)}function g(a){var c=e(),f=b.validate(c);f.length==0?($("#group_action_prompt_dialog").dialog("close"),a(null,c)):d(f)}function h(){d([]),$("#group_action_price_txt").val(""),$("#group_action_crv_txt").val(""),$("#group_action_is_taxable_txt").val(""),$("#group_action_is_sale_report_txt").val(""),$("#group_action_p_type_txt").val(""),$("#group_action_p_tag_txt").val(""),$("#group_action_vendor_txt").val(""),$("#group_action_cost_txt").val(""),$("#group_action_buydown_txt").val("")}function i(a){h(),d([]);var b="perform group action",c=g.bind(g,a),e=f.bind(f,a);$("#group_action_prompt_dialog").dialog({title:b,buttons:[{text:"Ok",click:c},{text:"Cancel",click:e}],modal:!0,width:600,heigh:400}),$("#group_action_prompt_dialog").dialog("open")}var c="ERROR_CANCEL_GROUP_ACTION_PROMPT";return{ERROR_CANCEL_GROUP_ACTION_PROMPT:c,exe:i}}),define("app/group/group_action_perform",["lib/async","app/group/group_action_prompt"],function(a,b){function c(a,b,c){var d={id:a,price:b.price,crv:b.crv,is_taxable:b.is_taxable,is_sale_report:b.is_sale_report,p_type:b.p_type,p_tag:b.p_tag,vendor:b.vendor,cost:b.cost,buydown:b.buydown};$.ajax({url:"/group/action",type:"POST",dataType:"json",data:d,success:function(a,b,d){c(null,a)},error:function(a,b,d){c(a)}})}function d(d,e){var f=c.bind(c,d.id);a.waterfall([b.exe,f],function(a,b){e(a,b)})}return{exe:d}}),requirejs.config({baseUrl:STATIC_URL+"js",paths:{app:"app",lib:"lib",jquery:["//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min","lib/jquery/jquery-1.11.0.min"],jquery_ui:["//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min","lib/jquery/jquery-ui-1.10.4.min"],jquery_block_ui:["//cdnjs.cloudflare.com/ajax/libs/jquery.blockUI/2.66.0-2013.10.09/jquery.blockUI.min","lib/jquery/jquery.blockUI"]},shim:{jquery_ui:["jquery"],jquery_block_ui:["jquery"]}}),require(["lib/misc/csrf_ajax_protection_setup","lib/async","lib/error_lib","app/group/group_inserter","app/group/group_updator","app/group/group_action_perform","jquery","jquery_block_ui","jquery_ui"],function(a,b,c,d,e,f){function i(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b.id){a[c]=b;break}}function j(a){if(a.group_child_set.length==0){alert("group is empty");return}action_perform_b=f.exe.bind(f.exe,a),b.waterfall([action_perform_b],function(a,b){if(a){c.alert_error(a);return}g=b.group_lst,m(),alert(b.row_update+" item(s) are updated")})}function k(a){var d=e.exe.bind(e.exe,a);b.waterfall([d],function(a,b){if(a){c.alert_error(a);return}i(g,b),m()})}function l(){b.waterfall([d.exe],function(a,b){if(a){c.alert_error(a);return}g.push(b),m()})}function m(){h.innerHTML="";var a,b;a=h.insertRow(-1);var c=["name","action","edit"];for(var d=0;d<c.length;d++)b=a.insertCell(-1),b.innerHTML=c[d];for(var d=0;d<g.length;d++){a=h.insertRow(-1);var e=g[d];b=a.insertCell(-1),b.innerHTML=e.name,b=a.insertCell(-1),b.innerHTML="action",function(a){b.addEventListener("click",function(){j(a)})}(g[d]),b=a.insertCell(-1),b.innerHTML="edit",function(a){b.addEventListener("click",function(){k(a)})}(g[d])}}var g=MY_GROUP_LST,h=document.getElementById("group_tbl");a(),$("#add_group_btn").off("click").click(l),m()}),define("app/group/group",function(){})